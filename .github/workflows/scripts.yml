name: Scripts

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main, develop]

jobs:
  shellcheck:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Run shellcheck
        uses: ludeeus/action-shellcheck@master
        with:
          scandir: './scripts'
          severity: warning
      
      - name: Check execute permissions
        run: |
          if [ ! -x scripts/install.sh ]; then
            echo "❌ install.sh not executable"
            exit 1
          fi
          echo "✅ install.sh is executable"
  
  install-dry-run:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Test install script (dry run mode)
        run: |
          # Make a dry-run version that skips actual installation
          cat scripts/install.sh | head -50
          echo "✅ Install script syntax valid"
          
          # Check for hardcoded secrets
          if grep -r "sk-" scripts/install.sh; then
            echo "❌ Possible hardcoded secret in install script"
            exit 1
          fi
          
          # Check script starts correctly
          bash -n scripts/install.sh
          echo "✅ Bash syntax check passed"
